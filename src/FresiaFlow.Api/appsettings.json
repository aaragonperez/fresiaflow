{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=fresiaflow;Username=postgres;Password=Fresia_31"
  },
  "OpenAI": {
    "ApiKey": "sk-proj-YOUR-API-KEY-HERE",
    "Model": "gpt-4o"
  },
  "Banking": {
    "Provider": "TrueLayer",
    "ApiKey": "your-banking-api-key-here",
    "BaseUrl": "https://api.truelayer.com"
  },
  "Storage": {
    "BasePath": "./uploads"
  },
  "IncomingInvoices": {
    "WatchFolder": "./incoming-invoices",
    "ProcessedSuccessFolder": "./processed/success",
    "ProcessedErrorFolder": "./processed/error",
    "ScanIntervalSeconds": 60
  },
  "InvoiceExtraction": {
    "Prompts": {
      "SystemMessage": "Eres un asistente experto en extracción de datos de facturas. Respondes únicamente con JSON válido.",
      "OwnCompanyNames": [
        "FRESIA SOFTWARE SOLUTIONS",
        "Fresia Software Solutions",
        "Fresia Software"
      ],
      "BasicExtractionTemplate": "Extrae los siguientes datos de la factura y devuélvelos en formato JSON estricto:\n\n{\n  \"InvoiceNumber\": \"string\",\n  \"IssueDate\": \"YYYY-MM-DD\",\n  \"DueDate\": \"YYYY-MM-DD\" o null,\n  \"Amount\": número decimal (sin símbolos de moneda),\n  \"SupplierName\": \"string\",\n  \"Confidence\": número decimal entre 0 y 1\n}\n\nIMPORTANTE:\n- InvoiceNumber: número de factura como string\n- IssueDate: fecha en formato ISO (YYYY-MM-DD)\n- DueDate: fecha en formato ISO (YYYY-MM-DD) o null si no existe\n- Amount: solo el número decimal, sin símbolos de moneda ni espacios (ej: 43.19, no \"43,19 €\")\n- SupplierName: nombre del proveedor\n- Confidence: nivel de confianza de la extracción (0.0 a 1.0)\n\nFACTURA:\n{0}",
      "CompleteExtractionTemplate": "Eres un asistente experto en análisis de facturas. Extrae la siguiente información de esta factura y devuélvela en formato JSON estricto.\n\nFACTURA:\n{0}\n\nIMPORTANTE - EXCLUSIÓN DE EMPRESAS PROPIAS:\nLas siguientes empresas son PROPIAS y NO deben ser consideradas como proveedores:\n{1}\n\nSi el proveedor de la factura coincide con alguna de estas empresas, NO proceses esta factura como factura recibida. En su lugar, devuelve null para supplierName o indica claramente que es una factura propia.\n\nCRÍTICO - EXTRACCIÓN DEL PROVEEDOR:\n- El PROVEEDOR (supplierName) es la empresa que EMITE la factura (quien vende/presta el servicio)\n- El proveedor aparece típicamente en la parte superior de la factura, en la sección \"EMISOR\", \"DE:\", \"FROM:\", o en el encabezado\n- El proveedor NO es el cliente (quien recibe la factura)\n- El proveedor NO es tu empresa propia (listada arriba)\n- SIEMPRE debes extraer el nombre completo del proveedor, incluso si es parcialmente visible\n- Si no puedes identificar claramente al proveedor, usa el nombre que aparezca en el campo de emisor/vendedor de la factura\n- NUNCA dejes supplierName vacío o null a menos que sea una empresa propia\n\nDevuelve ÚNICAMENTE un objeto JSON válido con esta estructura exacta (sin texto adicional):\n{\n  \"invoiceNumber\": \"string\",\n  \"supplierName\": \"string\",\n  \"supplierTaxId\": \"string o null\",\n  \"issueDate\": \"YYYY-MM-DD\",\n  \"dueDate\": \"YYYY-MM-DD o null\",\n  \"totalAmount\": number,\n  \"taxAmount\": number o null,\n  \"subtotalAmount\": number o null,\n  \"currency\": \"EUR\",\n  \"lines\": [\n    {\n      \"lineNumber\": 1,\n      \"description\": \"string\",\n      \"quantity\": number,\n      \"unitPrice\": number,\n      \"taxRate\": number o null,\n      \"lineTotal\": number\n    }\n  ]\n}\n\nReglas:\n- supplierName es OBLIGATORIO y debe contener el nombre de la empresa que emite la factura\n- Si no encuentras un campo, usa null para opcionales o un valor vacío/cero apropiado\n- Las fechas deben estar en formato ISO (YYYY-MM-DD)\n- Los números decimales deben usar punto como separador\n- El currency por defecto es EUR si no se especifica\n- Si no hay líneas detalladas, devuelve array vacío\n- NUNCA uses como supplierName ninguna de las empresas propias listadas arriba\n- Devuelve SOLO el JSON, sin markdown ni texto adicional"
    }
  }
}

